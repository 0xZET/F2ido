
type TagName= struct { string name; uint tag; };
type TagNames = TagName[];

fun tag = (string name, uint tag) TagName:
{
  return TagName{name=name, tag=tag};
};

fun tagName = (uint tag, TagNames ts) string:
{
  for (t in ts where t.tag == tag) {
    return t.name;
  };
  assert(0, format("invalid tag: %v (%v)", tag, ts));
};

fun printTag = (uint tag, TagNames ts) void:
{
  printf ("%s",tagName(tag, ts));
};

fun validTag = (uint tag, TagNames ts) uint:
{
  for (t in ts where t.tag == tag) {
    return 1;
  };
  return 0;
};

fun getTag = (string name, TagNames ts) uint:
{
  for (t in ts where t.name == name) {
    return t.tag;
  };
  assert(0, format("invalid tag name: %v (%v)", name, ts));
};
